networks:
  proxy:
    driver: bridge

services:
  reverse-proxy:
    container_name: reverse-proxy
    image: nginx:1.29.5
    ports:
      - "80:80"
      - "443:443"
      - "3306:3306"
    volumes:
      - "./nginx/config:/etc/nginx/conf.d:ro"
      - "./nginx/stream-config:/etc/nginx/stream.conf.d:ro"
      - "/var/www/certbot:/var/www/certbot:ro"
      - "/etc/letsencrypt:/etc/letsencrypt:ro"
      - "/var/log/nginx:/var/log/nginx"
      - "./nginx/nginx.conf:/etc/nginx/nginx.conf:ro"
    networks:
      - proxy

  hello-world:
    container_name: hello-world
    image: traefik/whoami
    networks:
      - proxy

  medhack-frontiers-db:
    container_name: medhack-frontiers-db-prod
    image: mysql:8.4.8
    environment:
      - MYSQL_ROOT_PASSWORD=${MEDHACK_FRONTIERS_DB_ROOT_PASSWORD}
      - MYSQL_DATABASE=medHackFrontiersDBprod
    volumes:
      - "./medhack-frontiers-db/prod:/var/lib/mysql"
    networks:
      - proxy

  medhack-frontiers-db-staging:
    container_name: medhack-frontiers-db-staging
    image: mysql:8.4.8
    environment:
      - MYSQL_ROOT_PASSWORD=${MEDHACK_FRONTIERS_DB_ROOT_PASSWORD}
      - MYSQL_DATABASE=medHackFrontiersDBstaging
    volumes:
      - "./medhack-frontiers-db/staging:/var/lib/mysql"
    networks:
      - proxy

  medhack-frontend:
    container_name: medhack-frontend
    image: caillinnugent/next-template-test:${FRONTEND_TAG}
    networks:
      - proxy